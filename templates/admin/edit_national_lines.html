{% extends "admin/base_admin.html" %}
{% block title %}编辑国家线数据 - 管理后台{% endblock %}

{% block admin_content %}
<div class="container-fluid px-4">
    <h1 class="mt-4">编辑国家线数据</h1>
    <ol class="breadcrumb mb-4">
        <li class="breadcrumb-item"><a href="{{ url_for('admin_dashboard') }}">仪表盘</a></li>
        <li class="breadcrumb-item active">编辑国家线数据</li>
    </ol>

    <div class="card mb-4">
        <div class="card-header">
            <i class="fas fa-chart-line me-1"></i>
            国家线数据
        </div>
        <div class="card-body">
            <p class="text-muted small">此数据用于首页的国家线相关图表。</p>
            <form method="POST" action="{{ url_for('admin_save_national_lines') }}">
                {{ form.hidden_tag() if form else '' }}

                {% if national_lines_data %}
                    {# 定义一个字典用于映射英文类别名到中文显示名 #}
                    {% set category_display_names = {
                        'total': '总分趋势',
                        'politics': '政治/英语趋势',
                        'others': '数/专科趋势'
                    } %}
                    {% for category_key, details in national_lines_data.items() %}
                        <h4 class="mt-4">{{ category_display_names.get(category_key, category_key|capitalize) }}</h4>
                        <div class="mb-3 row">
                            <label class="col-sm-2 col-form-label">年份:</label>
                            <div class="col-sm-10">
                                {% for year in details.years %}
                                    <input type="text" class="form-control d-inline-block me-2" style="width: auto;" name="{{category_key}}_years[]" value="{{ year }}">
                                {% endfor %}
                            </div>
                        </div>
                        {% for area, scores_list in details.scores.items() %}
                            <div class="mb-3 row">
                                <label class="col-sm-2 col-form-label">{{ area }} 分数:</label>
                                <div class="col-sm-10 score-inputs" id="scores-{{category_key}}-{{area.replace(' ', '_').replace('(','').replace(')','')}}">
                                    {% for score in scores_list %}
                                        <input type="number" step="0.5" class="form-control d-inline-block me-2" style="width: auto;" name="{{category_key}}_scores_{{area}}[]" value="{{ score }}">
                                    {% endfor %}
                                </div>
                            </div>
                        {% endfor %}
                        <hr>
                    {% endfor %}
                {% else %}
                    <p>没有加载到国家线数据。</p>
                {% endif %}

                <div class="d-flex justify-content-end mt-4">
                    <button type="submit" class="btn btn-primary">保存所有更改</button>
                </div>
            </form>
        </div>
    </div>
</div>

{% block admin_body_scripts %}
{{ super() }}
{% endblock %}

{% endblock %} 